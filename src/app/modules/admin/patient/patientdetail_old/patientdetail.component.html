<div class="patient-detail-page w-full">
    <div class="inner-page-header">
        <button mat-button class="back-btn" (click)="onBackPatient()"> <img src="../../../../../assets/back-arrow.svg" alt="" > Back to Patient Record</button>
    </div>
    <div class="section-header">
        <h2>Patient Details</h2>
        <div class="header-items">
            <button mat-stroked-button class="outline-btn" matTooltip="Add To Do"  >Add To Do</button>
            <button mat-stroked-button class="outline-btn" matTooltip="Add Notes">Add Notes</button>
        </div>
    </div>
    <div class="patient-widget">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="patient-widget-block">
                    <div class="patient-card">
                        <div class="patient-card-header">
                            <div class="patient-profile-img">

                                <img *ngIf="defaultimg" class="profile-img" style="height: 100%;" src="https://www.pixsy.com/wp-content/uploads/2021/04/ben-sweet-2LowviVHZ-E-unsplash-1.jpeg" alt=""  >
                                     <img *ngIf="imgURL" [src]="imgURL" class="profile-img">
                            </div>
                            <div class="patient-profile-info">
                                <div class="action-block">
                                    <button mat-icon-button >
                                        <img src="../../../../../assets/edit.svg" alt="" (click)="onUpdatePatient()">
                                      </button>
                                </div>
                                <div class="profile-info-container">
                                    <p class="name">{{first_name}} {{last_name}}</p>
                                    <span>{{Gender}}, {{Age}} </span> <span class="status active">{{Status}}</span>
                                </div>
                            </div>
                        </div>
                        <div class="patient-card-body">
                                <div class="grid grid-cols-1 sm:grid-cols-2 gap-5">
                                    <div class="patient-content">
                                        <label>MRN</label>
                                        <p>{{MRN}}</p>
                                    </div>
                                    <div class="patient-content">
                                        <label>Date of birth</label>
                                        <p>{{DOB}}</p>
                                    </div>
                                    <div class="patient-content">
                                        <label>Mobile phone number</label>
                                        <p>{{MobileNumber | mask: '(000) 000-0000'}}</p>
                                    </div>
                                    <div class="patient-content">
                                        <label>Location</label>
                                        <p>{{City}}</p>
                                    </div>
                                </div>
                        </div>
                    </div>
            </div>
            <div class="col-span-2 patient-widget-block">
                <div class="time-card">
                    <div class="time-card-header">
                        <h3>Consulting Time</h3>
                        <div class="right-col">
                            <button matTooltip="Download Reports" mat-button class="download-btn"  >
                                <img matSuffix src="../../../../../assets/download.svg" alt="">
                                Download Reports
                            </button>
                        </div>
                    </div>
                    <div class="time-card-body">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-5 items-center">
                            <div class="timer-block">
                                timer
                            </div>
                            <div class="timer-info-block col-span-2">
                                <div class="grid grid-cols-1 sm:grid-cols-2 gap-5">
                                    <div class="timer-content">
                                        <label>Total time spent this month:</label>
                                        <p>12 mins 14 secs</p>
                                    </div>
                                    <div class="timer-content">
                                        <label>Billable time recorded for current code:</label>
                                        <p>12 mins 14 secs</p>
                                    </div>
                                    <div class="timer-content">
                                        <label>Time remaining:</label>
                                        <p>07 mins 46 secs</p>
                                    </div>
                                    
                                </div>
                            </div>
                            </div>
                    </div>
                    <div class="time-card-footer">
                        <button mat-flat-button class="start-btn" >
                            <img matSuffix src="../../../../../assets/play.svg" alt="">
                            
                            Start Timer</button>
                        <button mat-flat-button class="stop-btn" >

                            <img matSuffix src="../../../../../assets/pause.svg" alt="">
                            
                            Pause Timer</button>
                        <button mat-flat-button color="primary">
                            <img matSuffix src="../../../../../assets/time.svg" alt="">
                            
                            Manage Recorded Time</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="table-container">

    <div class="table-filter">
        <mat-button-toggle-group class="tab-filter" >
            <mat-button-toggle  matTooltip="Periodic Vitals" value="">Periodic Vitals</mat-button-toggle>
            <mat-button-toggle  matTooltip="Monthly Vitals" value="">Monthly Vitals</mat-button-toggle>
            <mat-button-toggle  matTooltip="To Do" value="">To Do <strong>(3)</strong> </mat-button-toggle>
            <mat-button-toggle  matTooltip="Notes" value="">Notes</mat-button-toggle>
            <mat-button-toggle  matTooltip="Message Patient" value="">Message Patient</mat-button-toggle>
        </mat-button-toggle-group>
        <div class="action-block ml-auto">
            <button mat-stroked-button class="outline-btn" matTooltip="Manage Threshold"  >Manage Threshold</button>
        </div>
    </div>
        <div class="table-wrapper">
            <div class="table-block">

                table
            </div>
        </div>
    </div>
    </div>
    <ng-template #updatePatient>
        <div class="dialog-content-wrapper ">
        <div class="add-patient-modal">
            <div class="modal-header">
                <h2>Patient information</h2>
            </div>
            <div class="modal-body">
                <div class="modal-tab-container">
                    <mat-button-toggle-group class="modal-tab" #group="matButtonToggleGroup" value="0">
                        <mat-button-toggle  matTooltip="Basic Info" (change)="onValChange($event.value)" value="0">Basic Info  </mat-button-toggle>
                        <mat-button-toggle  matTooltip="Device Info" (change)="onValChange($event.value)" value="1">Device Info</mat-button-toggle>
                        <mat-button-toggle  matTooltip="ICD Code" (change)="onValChange($event.value)" value="2">ICD Code</mat-button-toggle>
                    </mat-button-toggle-group>
                </div>
                <form [formGroup]="firstForm" >
                  <div class="basicInfo" *ngIf="tab=='basicInfo'">
                    <p *ngIf="emailError">{{emailError}}</p>
                    <div class="input-block">
                        <div class="grid grid-cols-6">
                            <div class="col-span-6 sm:col-span-3">
                                <p><b>Enrollment date: </b>{{created_at}}</p>
                                <mat-form-field class="w-full" appearance="fill">
                                    <mat-label>First Name &nbsp;<span style="color:red;">*</span></mat-label>
                                    <input type="text" matInput formControlName="firstName" id="firstName" [errorStateMatcher]="matcher" (change)="removeSpace(firstForm.value.firstName,'modelFirstName')">
                                    <mat-error *ngIf="firstForm.get('firstName').hasError('required')">
                                    Please Enter First Name
                                  </mat-error>
                                  <mat-error *ngIf="firstForm.get('firstName').hasError('pattern')">
                                        Please Enter whithout space
                                      </mat-error>
                                      <mat-error *ngIf="firstForm.get('firstName').hasError('whitespace')">Please enter valid data</mat-error>
                                </mat-form-field>
                            </div>
                            <div class="col-span-6 sm:col-span-3">
                                <p><b>Enrollment visit completed by: </b>NA</p>
                                <mat-form-field class="w-full" appearance="fill">
                                    <mat-label>Last Name &nbsp;<span style="color:red;">*</span></mat-label>
                                    <input matInput formControlName="lastName" id="lastName" [errorStateMatcher]="matcher" (change)="removeSpace(firstForm.value.lastName,'modelLastName')">
                                    <mat-error *ngIf="firstForm.get('lastName').hasError('required')">
                                    Please Enter Last Name
                                  </mat-error>
                                </mat-form-field>
                            </div>
                            <div class="col-span-6 sm:col-span-3">
                                <mat-form-field class="w-full date-picker" appearance="fill">
                                    <mat-label>Date Of Birth &nbsp;<span style="color:red;">*</span></mat-label>
                                    <input matInput [matDatepicker]="picker" formControlName="dateOfBirth" id="dateOfBirth" [min]="oldDate" [max]="tomorrow" [errorStateMatcher]="matcher">
                                    <mat-datepicker-toggle matSuffix [for]="picker">
                                            <img matDatepickerToggleIcon style="width: 15px;" src="../../../../../assets/calendar.svg" alt="">
                                    </mat-datepicker-toggle>
                                    <mat-datepicker #picker></mat-datepicker>
                                    <mat-error *ngIf="firstForm.get('dateOfBirth').hasError('required')">
                                    Please Select Date of Birth
                                  </mat-error>
                                </mat-form-field>

                            </div>
                            <div class="col-span-6 sm:col-span-3">
                                <mat-form-field class="w-full" appearance="fill">
                                    <mat-label>Email &nbsp;<span style="color:red;">*</span></mat-label>
                                    <input type="email" matInput formControlName="email" id="email" [errorStateMatcher]="matcher">
                                    <mat-error *ngIf="firstForm.get('email').hasError('required')">
                                    Please Enter the Email
                                  </mat-error>
                                  <mat-error *ngIf="firstForm.get('email').hasError('pattern')">
                                    Please Enter the Valid Email
                                  </mat-error>
                                </mat-form-field>
                            </div>
                            <div class="col-span-6 sm:col-span-3">
                                <mat-form-field class="w-full" appearance="fill">
                                    <mat-label>Mobile phone number &nbsp;<span style="color:red;">*</span></mat-label>
                                    <input mask="(000) 000-0000" matInput formControlName="mobileNumber" id="mobileNumber" [errorStateMatcher]="matcher">
                                        <mat-error *ngIf="firstForm.get('mobileNumber').hasError('required')">
                                        Please Enter Mobile Number
                                    </mat-error>
                                    <mat-error *ngIf="firstForm.get('mobileNumber').hasError('pattern')">
                                        Please Enter 10 digit Number
                                      </mat-error>
                                    </mat-form-field>
                            </div>
                            <div class="col-span-6 sm:col-span-3">
                                <mat-form-field class="w-full" appearance="fill">
                                    <mat-label>Home phone number &nbsp;<span style="color:red;">*</span></mat-label>
                                    <input mask="(000) 000-0000" matInput formControlName="homeNumber" id="homeNumber" [errorStateMatcher]="matcher">
                                    <mat-error *ngIf="firstForm.get('homeNumber').hasError('required')">
                                    Please Enter Home Phone Number
                                  </mat-error>
                                  <mat-error *ngIf="firstForm.get('homeNumber').hasError('pattern')">
                                        Please Enter 10 digit Number
                                      </mat-error>
                                </mat-form-field>
                            </div>
                        </div>    
                    </div>
                    <div class="input-block">
                    <div class="grid grid-cols-6 ">
                        <div class="col-span-6 sm:col-span-3">
                            <mat-form-field class="w-full" appearance="fill">
                                <mat-label>Address Line 1</mat-label>
                                <input matInput  type="text" formControlName="addressline1" id="addressline1" [errorStateMatcher]="matcher" (change)="removeSpace(firstForm.value.addressline1,'modelAddressLine1')" >
                                <mat-error *ngIf="firstForm.get('addressline1').hasError('required')">
                                        Please Enter Address Line 1
                                        </mat-error>
                              </mat-form-field>
                        </div>
                        <div class="col-span-6 sm:col-span-3">
                            <mat-form-field class="w-full" appearance="fill">
                                <mat-label>Address Line 2</mat-label>
                                <input matInput  type="text" formControlName="addressline2" id="addressline2" [errorStateMatcher]="matcher" (change)="removeSpace(firstForm.value.addressline2,'modelAddressLine2')" >
                                <mat-error *ngIf="firstForm.get('addressline2').hasError('required')">
                                        Please Enter Address Line 2
                                        </mat-error>
                              </mat-form-field>
                        </div>
                        <div class="col-span-6 sm:col-span-3">
                            <mat-form-field class="w-full" appearance="fill">
                                <mat-label>City</mat-label>
                                <input matInput type="text" formControlName="city" id="city" [errorStateMatcher]="matcher" (change)="removeSpace(firstForm.value.city,'modelCity')">
                                <mat-error *ngIf="firstForm.get('city').hasError('required')">
                                        Please Enter City
                                        </mat-error>
                              </mat-form-field>
                        </div>
                        <div class="col-span-6 sm:col-span-3">
                            <mat-form-field class="w-full" appearance="fill" >
                                <mat-label>State</mat-label>
                                <mat-select formControlName="state" id="state" [errorStateMatcher]="matcher" [(ngModel)]="fromState">
                                  <mat-option *ngFor="let state of stateList" [value]="state.id">
                                          {{state.name}}
                                  </mat-option>
                                </mat-select>
                                <mat-error *ngIf="firstForm.get('state').hasError('required')">
                                        Please Select State
                                        </mat-error>
                              </mat-form-field>
                        </div>
                        <div class="col-span-6 sm:col-span-3">
                            <mat-form-field class="w-full" appearance="fill">
                                <mat-label>Zip</mat-label>
                                <input matInput  type="text" formControlName="zip" id="zip" [errorStateMatcher]="matcher" (change)="removeSpace(firstForm.value.zip,'modelZip')">
                                <mat-error *ngIf="firstForm.get('zip').hasError('required')">
                                        Please Enter Zip
                                        </mat-error>
                              </mat-form-field>
                        </div>
                    </div>
                    <mat-checkbox formControlName="shippingAddress"
                    [color]="'primary'" class="mb-6" (change)="shippingAddressChange($event)" [ngModel]="shippingAddressModel" 
                >
                Shipping address is different than the primary address
                </mat-checkbox>
                <div class="input-block" *ngIf="shippingAddressModel!=true" class="shippingAddress">
                    <p>Shipping Address</p>
                    <div class="grid grid-cols-6 ">
                        <div class="col-span-6 sm:col-span-3">
                            <mat-form-field class="w-full" appearance="fill">
                                <mat-label>Shipping Address Line 1</mat-label>
                                <input matInput  type="text" formControlName="shippingaddressline1" id="shippingaddressline1" [errorStateMatcher]="matcher" (change)="removeSpace(firstForm.value.shippingaddressline1,'modelShippingAddressLine1')">
                                <mat-error *ngIf="firstForm.get('shippingaddressline1').hasError('required')">
                                        Please Enter Shipping Address Line 1
                                        </mat-error>
                              </mat-form-field>
                        </div>
                        <div class="col-span-6 sm:col-span-3">
                            <mat-form-field class="w-full" appearance="fill">
                                <mat-label>Shipping Address Line 2</mat-label>
                                <input matInput  type="text" formControlName="shippingaddressline2" id="shippingaddressline2" [errorStateMatcher]="matcher" (change)="removeSpace(firstForm.value.shippingaddressline2,'modelShippingAddressLine2')">
                                <mat-error *ngIf="firstForm.get('shippingaddressline2').hasError('required')">
                                        Please Enter Shipping Address Line 2
                                        </mat-error>
                              </mat-form-field>
                        </div>
                        <div class="col-span-6 sm:col-span-3">
                            <mat-form-field class="w-full" appearance="fill">
                                <mat-label>Shipping City</mat-label>
                                <input matInput type="text" formControlName="shippingcity" id="city" [errorStateMatcher]="matcher" (change)="removeSpace(firstForm.value.shippingcity,'modelShippingCity')">
                                <mat-error *ngIf="firstForm.get('shippingcity').hasError('required')">
                                        Please Enter Shipping City
                                        </mat-error>
                              </mat-form-field>
                        </div>
                        <div class="col-span-6 sm:col-span-3">
                            <mat-form-field class="w-full" appearance="fill" >
                                <mat-label>Shipping State</mat-label>
                                <mat-select formControlName="shippingstate" id="shippingstate" [errorStateMatcher]="matcher" [(ngModel)]="shippState">
                                  <mat-option *ngFor="let state of stateList" [value]="state.id">
                                          {{state.name}}
                                  </mat-option>
                                </mat-select>
                                <mat-error *ngIf="firstForm.get('shippingstate').hasError('required')">
                                        Please Select Shipping State
                                        </mat-error>
                              </mat-form-field>
                        </div>
                        <div class="col-span-6 sm:col-span-3">
                            <mat-form-field class="w-full" appearance="fill">
                                <mat-label>Shipping Zip</mat-label>
                                <input matInput  type="text" formControlName="shippingzip" id="shippingzip" [errorStateMatcher]="matcher" (change)="removeSpace(firstForm.value.shippingzip,'modelShippingZip')">
                                <mat-error *ngIf="firstForm.get('shippingzip').hasError('required')">
                                        Please Enter Shipping Zip
                                        </mat-error>
                              </mat-form-field>
                        </div>
                    </div>
                </div>
                <div class="grid grid-cols-6 col-span-6">
                        <div class="col-span-6 sm:col-span-3">
                            <mat-form-field class="w-full" appearance="fill">
                                <mat-label>Gender&nbsp;<span style="color:red;">*</span></mat-label>
                                <mat-select formControlName="gender" id="gender" [errorStateMatcher]="matcher" [(ngModel)]="selectGender">
                                        <mat-option value="0">Male</mat-option>
                                        <mat-option value="1">Female</mat-option>
                                </mat-select>
                                <mat-error *ngIf="firstForm.get('gender').hasError('required')">
                                Please Select Gender
                            </mat-error>
                            </mat-form-field>
                        </div>
                    <div class="col-span-6 sm:col-span-3">
                        <mat-label>Preferred language</mat-label>
                        <mat-radio-group [color]="'primary'" aria-label="Select an mat-option" formControlName="preferredLanguage" id="preferredLanguage" [errorStateMatcher]="matcher">
                            <!-- <mat-radio-button value="1">English</mat-radio-button>
                            <mat-radio-button value="2">Spanish</mat-radio-button> -->
                            <mat-radio-button *ngFor="let preferredLanguage of preferredLanguageList" [value]="preferredLanguage.value" name="preferredLanguage.name" [checked]="preferredLanguage.checked" (change)="radioSelectChange(preferredLanguage,preferredLanguageList)">{{ preferredLanguage.name}}</mat-radio-button>
                        </mat-radio-group>
                    </div>
                </div>
                <div class="flex mt-2">
                        <p class="mr-4">Blood Pressure Threshold (average)</p>
                        <mat-checkbox
                        [color]="'primary'"
                        class="mr-7"
                        formControlName="sevendays"
                    >
                    7 Days
                    </mat-checkbox>
                    <mat-checkbox
                        [color]="'primary'"
                        formControlName="tenreadings"
                    >
                    10 Readings
                    </mat-checkbox>
                 </div>
               </div>
                    
                
            </div>
            <div class="deviceInfo" *ngIf="tab=='deviceInfo'">
                <!-- Device Info Start -->
                        <div class="device-info-container">
                                <div class="image-uploader mb-4">
                                    <input type="file" name="" hidden id="file" (change)="onSelect($event)">
                                    <label for="file">
                                        <img *ngIf="defaultimg" class="profile-img" src="https://www.pixsy.com/wp-content/uploads/2021/04/ben-sweet-2LowviVHZ-E-unsplash-1.jpeg" alt="" >
                                        <img src="../../../../../assets/default-img.svg" alt="" >
                                        <div *ngIf="imgURL" style="height:100%;">
                                            <img [src]="imgURL" style="object-fit: contain;" class="image_preview">
                                        </div>
                                    </label>
                                </div>
                                <h3>Device Information</h3>
                                <button ngif="deviceType" class="bp-link-btn" href="">{{deviceType}}</button>
                                <div class="device-info-block ">
                                    <h3 class="mb-4">Order Information:</h3>
                                        <div class="input-block">
                                            <div class="grid grid-cols-6 items-center">
                                                <div class="col-span-6 sm:col-span-3">
                                                    <label >Kit order received date:</label>
                                                </div>
                                            <div class="col-span-6 sm:col-span-3">
                                                <p>{{kitorderdate}}</p>
                                                <!--<mat-form-field class=" date-picker" appearance="fill">
                                                     <input matInput [matDatepicker]="picker" formControlName="kitorderdate" id="kitorderdate" >
                                                    <mat-datepicker-toggle matSuffix [for]="picker">
                                                        <img matDatepickerToggleIcon style="width: 15px;" src="../../../../../assets/calendar.svg" alt="">
                                                    </mat-datepicker-toggle>
                                                    <mat-datepicker #picker></mat-datepicker>
                                                </mat-form-field> -->
                                            </div>
                                            </div>
                                        </div>
                                        <div class="input-block">
                                            <div class="grid grid-cols-6 items-center">
                                                <div class="col-span-6 sm:col-span-3">
                                                    <label >Order processed date:</label>
                                                </div>
                                            <div class="col-span-6 sm:col-span-3">
                                                <p>{{orderprocesseddate}}</p>
                                               <!--  <mat-form-field class=" date-picker" appearance="fill">
                                                    <input matInput [matDatepicker]="pickerprocessed" formControlName="orderprocesseddate" id="orderprocesseddate" >
                                                    <mat-datepicker-toggle matSuffix [for]="pickerprocessed">
                                                        <img matDatepickerToggleIcon style="width: 15px;" src="../../../../../assets/calendar.svg" alt="">
                                                    </mat-datepicker-toggle>
                                                    <mat-datepicker #pickerprocessed></mat-datepicker> 
                                                </mat-form-field>-->
                                            </div>
                                            </div>
                                        </div>
                                        <div class="input-block">
                                            <div class="grid grid-cols-6 items-center">
                                                <div class="col-span-6 sm:col-span-3">
                                                    <label >Order shipped date:</label>
                                                </div>
                                            <div class="col-span-6 sm:col-span-3">
                                                <p>{{ordershippeddate}}</p>
                                               <!-- <mat-form-field class=" date-picker" appearance="fill">
                                                     <input matInput [matDatepicker]="pickershipped" formControlName="ordershippeddate" id="ordershippeddate" >
                                                    <mat-datepicker-toggle matSuffix [for]="pickershipped">
                                                        <img matDatepickerToggleIcon style="width: 15px;" src="../../../../../assets/calendar.svg" alt="">
                                                    </mat-datepicker-toggle>
                                                    <mat-datepicker #pickershipped></mat-datepicker> 
                                                </mat-form-field>-->
                                            </div>
                                            </div>
                                        </div>
                                    </div>
                                    <button mat-stroked-button   class="outline-button">Request Another Device</button>
                        </div>
                        <!-- Device Info End -->
            </div>
            <div class="icdcode" *ngIf="tab=='icdcode'">
                <!-- ICD Code start -->
                        <div class="ICD-code-container">
                            <div class="grid grid-cols-6 items-center">
                                <div class="col-span-6 sm:col-span-3">
                                    <label>Current ICD 10 Code:</label>
                                    </div>
                                    <div class="col-span-6 sm:col-span-3">
                                        <span class="value">I 10</span>
                                        </div>
                                </div>
                                <div class="input-block mt-7">
                                    <label >Add ICD 10 Code:</label>
                                        <mat-form-field class="w-full" appearance="fill">
                                            <input matInput type="text" formControlName="icdcode" id="icdcode" [errorStateMatcher]="matcher" [(ngModel)]="modelIcd">
                                        </mat-form-field>
                                </div>
                            </div>
                        <!-- ICD Code end -->
            </div>
            <div class="form-action">
                        <button mat-stroked-button class="cancel-btn" (click)="cancelPopup()">Cancel</button>
                        <button (click)="onfirstFormSubmit()" mat-flat-button color="primary" class="next-btn">
                            Save Patient Details
                            <mat-icon aria-hidden="false" aria-label="Example home icon">chevron_right</mat-icon>

                        </button>

                    </div>
          </form>      
        </div> 

    </div> 
    </div>
    </ng-template>
<ng-template #firstFormDialog>
    <p>ssss</p>
</ng-template>